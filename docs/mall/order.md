# 订单相关接口

[TOC]
## 修订记录
----
日期 | 作者 | 修订类型 | 修订内容 | 版本|
---- | ---- | ---- | ---- | ---- |
2020年07月03日|冷立纲|A|新增设计方案|1.0|

> 【修订类型：A-新增  M-修改 D-删除】

## 背景

订单相关接口

## 产品说明



## 关键流程说明

## 接口说明


#### 1.0 提交订单

##### 接口说明

提交订单并支付

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /order/submit |

#####  输入参数

_订单信息_

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
| cartId      | 否|  int  |  购物车ID  |  只结算指定购物车结算项的产品，不填则结算所有选中产品 |
| addressId      | 否|  int  |  地理位置ID  |  不填则获取下面的地址信息建立地址 |
| couponId      | 否|  int  |  优惠券ID  |  指定使用的优惠券 |
| userCouponId      | 否|  int  |  用户优惠券ID  |  指定用户已领取的优惠券ID|
| message      | 否|  string  |  备注信息  |  |
| grouponRulesId      | 否|  int  |  团购规则ID  | 预留团购，暂时用不到 |
| grouponLinkId      | 否|  int  |  团购ID  | 预留团购，暂时用不到 |
| payType      | 是|  string  |  支付方式  |  根据结算页拉取的支付项填写，小程序可以固定写死 WX_MP|


_地址信息_ (若上面 addressId 为空，则地址信息为必填项)


| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  name      | 是|  string  |  名称 | |
|  province      | 是|  string  |  省份 | |
|  city      | 是|  string  |  城市 | |
|  county      | 是|  string  |  乡 | |
|  addressDetail      | 是|  string  |  详细地址 | |
|  areaCode      | 是|  string  |  地址编码| |
|  postalCode      | 否|  string  |  邮政编码| |
|  tel      | 是|  string  |  电话 | |
|  isDefault      | 是|  boolean  | 是否默认地址 | |


#####  错误说明




#####  返回实例
```json
    
    {
    "c": 0,
    "m": null,
    "d": {
            "payOrderId":xxxx,//订单号
            "callPayInfo":xxxxx, //各平台对应支付信息 
       }
    }

```



#### 1.1 取消订单

##### 接口说明

根据订单ID获取订单详细信息

##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /order/cancel |

#####  输入参数


| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
| orderId      | 是|  int  |  订单详细信息  |  |


#####  错误说明




#####  返回实例
```json
    
    {
    "c": 0,
    "m": null,
    "d": {
           
       }
    }

```


#### 1.2 支付订单

##### 接口说明

根据订单ID获取订单详细信息

##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /order/prepay |

#####  输入参数


| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
| orderId      | 是|  int  |  订单ID  |  订单号 |
| payType      | 是|  string  |  支付方式  |  根据结算页拉取的支付项填写，小程序可以固定写死 WX_MP|






#####  错误说明




#####  返回实例
```json
    
   {
    "c": 0,
    "m": null,
    "d": {
            "payOrderId":xxxx,//订单号
            "callPayInfo":xxxxx, //各平台对应支付信息 
       }
    }

```




#### 1.1 订单列表

##### 接口说明

订单列表信息

##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /order/detail |

#####  输入参数


| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
| showType      | 是|  int  |  订单列表  | 显示类型，0，全部订单； 1，待付款； 2，待发货； 3，待收货； 4，待评价。  |
| page      | 否|  int  |  分页  | 默认1  |
| limit      | 否|  int  |  限制单页条数  | 默认10  |






#####  错误说明




#####  返回实例
```json
    
{
    "c": 0,
    "m": null,
    "d": {
        "pageSize": 10,
        "currentPage": 1,
        "list": [
            {
                "id": 5,  //订单ID
                "orderSn": "20200613513109",   //订单SN
                "actualPrice": 1998.00, //订单金额
                "orderStatusText": "已取消(系统)", //订单状态描述
                "handleOption": {
                    "cancel": false,  //是否可取消
                    "delete": true, //是否可删除
                    "pay": false, //是否可支付
                    "comment": false, //是否可评价
                    "confirm": false, //是否可确认收货
                    "refund": false, //是否可退货
                    "rebuy": false, //是否可重新购买
                    "aftersale": false  //是否可售后
                },
                "aftersaleStatus": 0,  //售后状态，0是可申请，1是用户已申请，2是管理员审核通过，3是管理员退款成功，4是管理员审核拒绝，5是用户已取消
                "goodsList": [], //产品列表
                "groupin": false  //是否团购
            }      
         ],
        "end": true,
        "startIndex": 0,
        "empty": false
    }
}
```







